const playlist = [
  {
    title: "Unknown title",
    artist: "Unknown artist",
    album: "Unknown album",
    src: "music/placeholder.mp3",
    cover: "img/unknown.png",
    coverSize: "1000x1000",
    lyrics: "<br>",
    background: "linear-gradient(#515151, #121212)",
    lyricsBackground: "#515151",
    explicit: "0"
  },
  {
    title: "OSCAR",
    artist: "Young Multi, White Widow",
    album: "TOXIC",
    src: "music/oscar.mp3",
    cover: "img/toxic.png",
    coverSize: "1200x1200",
    lyrics: "CaÅ‚y pachnÄ™ stylem to przyciÄ…ga twojÄ… hoe<br>Nie chcÄ™ sÅ‚uchaÄ‡ plotek moje Å¼ycie to real talk<br>WszÄ™dzie drogie ciuchy drogie kurwy drogie flow<br>PrzestaÅ„ moje Å¼ycie filmy akcji twoje to komedia<br>ZÅ‚oty chÅ‚opak ale nie mam nic z aktora<br>Bez czapy pÅ‚ynÄ™ zawsze a naleÅ¼y mi siÄ™ Oscar<br>Jak wpadajÄ… ziomy na crib to powstaÅ„<br>Jak wpadajÄ… ziomy na crib to powstaÅ„<br><br>Od maÅ‚ego chciaÅ‚em mieÄ‡ diamenty<br>Zanim zrobiÅ‚em je z Bedim czuÅ‚em siÄ™ przeklÄ™ty<br>Historia znÃ³w zatacza koÅ‚o znowu underrated<br>Ale suko nigdy over nigdy nie odejde<br>Nasz shit fresh to markowy sort<br>Gruby trap CEO big boss jak Rick Ross<br>Ugh smutna bitch ona szuka clout'u<br>Ona zrobi dzisiaj wszystko dla kontraktu<br>Moje ziomy status free agent<br>Robimy to na swoim jebaÄ‡ major label<br>Zobacz tylko jak ten styl wchodzi<br>Mam go dawno suko od narodzin<br>DuÅ¼e body duÅ¼e fele<br>DuÅ¼y ass duÅ¼y joint no i jest weselej<br>BiaÅ‚y chÅ‚opak ale luz mam<br>No i lubiÄ™ kiedy ona egzotyczna<br><br>CaÅ‚y pachnÄ™ stylem to przyciÄ…ga twojÄ… twojÄ… hoe<br>Nie chcÄ™ sÅ‚uchaÄ‡ plotek moje Å¼ycie to real talk<br>WszÄ™dzie drogie ciuchy drogie kurwy drogie flow<br>PrzestaÅ„ moje Å¼ycie filmy akcji twoje to komedia<br>ZÅ‚oty chÅ‚opak ale nie mam nic z aktora<br>Bez czapy pÅ‚ynÄ™ zawsze a naleÅ¼y mi siÄ™ Oscar<br>Jak wpadajÄ… ziomy na crib to powstaÅ„<br>Jak wpadajÄ… ziomy na crib to powstaÅ„<br><br>One kochajÄ… nasz styl chciaÅ‚y byÄ‡ tu z nami<br>Oni chcieli pograÄ‡ z nami lecz to nie Konami<br>Ma byÄ‡ cuban link wypeÅ‚niony diamentami (VVS)<br>Egzotyczna hoe chciaÅ‚a byÅ›my byli sami (yeah)<br>MaÅ‚a zrobisz team potem moÅ¼esz sobie iÅ›Ä‡ (to the team)<br>Bitch we 'bout that action nie jesteÅ›my wannabes (nie)<br>Urodzony na tych blokach lil hood baby shit (okay)<br>Ja liczÄ™ na skÅ‚ad dawno juÅ¼ nie liczÄ™ liczb (squad)<br>I got the keys maÅ‚a suko jak Future (jak Future)<br>Ja to nauczyciel ty co najwyÅ¼ej to uczeÅ„ (yeah)<br>MaÅ‚y ziomie przypominasz troche router (trochÄ™ co)<br>Chodzi o router co ma parÄ™ zakÅ‚Ã³ceÅ„ (let's go)<br><br>CaÅ‚y pachnÄ™ stylem to przyciÄ…ga twojÄ… twojÄ… hoe<br>Nie chcÄ™ sÅ‚uchaÄ‡ plotek moje Å¼ycie to real talk<br>WszÄ™dzie drogie ciuchy drogie kurwy drogie flow<br>PrzestaÅ„ moje Å¼ycie filmy akcji twoje to komedia<br>ZÅ‚oty chÅ‚opak ale nie mam nic z aktora<br>Bez czapy pÅ‚ynÄ™ zawsze a naleÅ¼y mi siÄ™ Oscar<br>Jak wpadajÄ… ziomy na crib to powstaÅ„<br>Jak wpadajÄ… ziomy na crib to powstaÅ„<br><br>RobiÄ™ ballin' out suko a to gÃ³wno nie dla was (pow pow)<br>Dziwko u mnie nie ma puchy tylko szybko mija czas (mija czas)<br>Mija dwie trzy minuty albo caÅ‚y kilogram (ay yeah)<br>Benz Benz Gucci Gucci I've been flexin' all the time (Gucci Gucci)<br>Nie podzieli nas suka i nominaÅ‚ (w chuju nominaÅ‚)<br>W chuju mam wasze opinie was o rady nie pytam<br>Nie chcÄ™ sÅ‚uchaÄ‡ twojej nuty bo siÄ™ zaraz zerzygam (zerzygam)<br>Ona skacze na giwere ja za wÅ‚osy jÄ… chwytam (yikes)<br>U mnie balet peÅ‚en ziomÃ³w a u ciebie jest stypa (huh)<br>TwÃ³j ziom faja jebana a siÄ™ kreuje na gita (okay)<br>Suka udaje doznania bo ledwo co jÄ… dotykasz (pow pow)<br>Ty jesteÅ› paÅ‚Ä… do szczania i caÅ‚a ta twoja klika (pow)<br><br>CaÅ‚y pachnÄ™ stylem to przyciÄ…ga twojÄ… twojÄ… hoe<br>Nie chcÄ™ sÅ‚uchaÄ‡ plotek moje Å¼ycie to real talk<br>WszÄ™dzie drogie ciuchy drogie kurwy drogie flow<br>PrzestaÅ„ moje Å¼ycie filmy akcji twoje to komedia<br>ZÅ‚oty chÅ‚opak ale nie mam nic z aktora<br>Bez czapy pÅ‚ynÄ™ zawsze a naleÅ¼y mi siÄ™ Oscar<br>Jak wpadajÄ… ziomy na crib to powstaÅ„<br>Jak wpadajÄ… ziomy na crib to powstaÅ„<br>",
    background: "linear-gradient(#e81e2a, #121212)",
    lyricsBackground: "#e81e2a",
    explicit: "1"
  },
  {
    title: "BALLADA O SAMOTNOÅšCI (vlone)",
    artist: "Young Multi",
    album: "TOXIC",
    src: "music/ballada-o-samotnosci.mp3",
    cover: "img/toxic.png",
    coverSize: "1200x1200",
    lyrics: "Co to jest miÅ‚oÅ›Ä‡?<br>Åzy znowu lecÄ… mi na nowy Vlone na na<br>Do zdjÄ™cia uÅ›miech a wszystko siÄ™ zmienia<br>Gdy w pokoju zostajÄ™ juÅ¼ tylko sam<br>Na na na na na na<br>ZostajÄ™ sam<br>Na na na na na na<br>ZostajÄ™ sam<br>Co to jest miÅ‚oÅ›Ä‡?<br>",
    background: "linear-gradient(#e81e2a, #121212)",
    lyricsBackground: "#e81e2a",
    explicit: "1"
  },
  {
    title: "ZIOMECZKI ZIOMY",
    artist: "Young Multi",
    album: "TOXIC",
    src: "music/ziomeczki-ziomy.mp3",
    cover: "img/toxic.png",
    coverSize: "1200x1200",
    lyrics: "DzwoniÄ™ do ziomeczkÃ³w ziomÃ³w<br>DzwoniÄ™ do ziomeczkÃ³w ziomÃ³w<br>Kiedy potrzebujÄ™ brokuÅ‚Ã³w<br>Kiedy nie majÄ… co robiÄ‡ na chacie to gramy tu z nudÃ³w yeah<br>CzujÄ™ dobry vibe niech tak juÅ¼ bÄ™dzie bez kÅ‚Ã³tni i brudÃ³w<br>Yeah slatt<br>DzwoniÄ™ do dzwoniÄ™ do ziomeczkÃ³w ziomÃ³w<br>",
    background: "linear-gradient(#e81e2a, #121212)",
    lyricsBackground: "#e81e2a",
    explicit: "1"
  },
  {
    title: "BEKSA",
    artist: "Young Multi",
    album: "TOXIC",
    src: "music/beksa.mp3",
    cover: "img/toxic.png",
    coverSize: "1200x1200",
    lyrics: "W Å‚apie mam telefon, a na koncie trzymam se tysiÄ…ce<br>Ale martwiÄ™ siÄ™ bo jakiÅ› pajac, w komentarzu mi napisaÅ‚ Å¼e siÄ™ koÅ„czÄ™<br>Co za bezsens, kiedyÅ› marzyÅ‚em o tym miejscu w ktÃ³rym dziÅ› jestem<br>Presja mnie wykaÅ„cza bo oczekujÄ… tu wiÄ™cej, ale jak upadasz kto ci poda rÄ™kÄ™<br>Nie chcÄ™ wyjÅ›Ä‡ na beksÄ™, ale komu siÄ™ wypÅ‚akaÄ‡ kiedy kÅ‚uje serce<br>TysiÄ…ce ludzi chce zajÄ…Ä‡ twoje miejsce<br>TysiÄ…ce ludzi chce wbijaÄ‡ na backstage'e<br>Daj mi tysiÄ…c miÅ‚oÅ›ci albo nic<br>Tym co poszli chuj do dupy albo chuj im w ryj<br>ChcÄ™ Å¼ebyÅ› przy mnie byÅ‚ nawet kiedy nie mam siÅ‚<br>ChcÄ™ Å¼ebyÅ› przy mnie byÅ‚ nawet kiedy nie mam siÅ‚<br><br>Powiedz czego chcesz<br>Popatrz na mnie powiedz â€jest okejâ€<br>Popatrz na mnie powiedz â€jest okejâ€<br>I potem przytul mnie<br>Szepnij mi do ucha â€jest okejâ€<br>Podaj rÄ™kÄ™ kiedy bÄ™dzie Åºle<br>Powiedz czego chcesz<br>Popatrz na mnie powiedz â€jest okejâ€<br>Popatrz na mnie powiedz â€jest okejâ€<br>I potem przytul mnie<br>Szepnij mi do ucha â€jest okejâ€<br>Podaj rÄ™kÄ™ kiedy bÄ™dzie Åºle<br><br>ByÅ‚em juÅ¼ na szczycie na dole, na szczycie na dole, na szczycie na dole, na szczycie na dole<br>JakbyÅ› przeÅ¼yÅ‚ rollercoaster na mym miejscu<br>To byÅ› albo nie Å¼yÅ‚ albo zrezygnowaÅ‚ juÅ¼ na wejÅ›ciu<br>SÄ… momenty kiedy chciaÅ‚em skoÅ„czyÄ‡ z tym<br>Ale obiecaÅ‚em nie dam satysfakcji im<br>Kiedy masz na bani taki syf, ciÄ™Å¼ko znaleÅºÄ‡ siÅ‚Ä™ mi by do przodu iÅ›Ä‡<br>By do przodu iÅ›Ä‡ huh<br>By do przodu iÅ›Ä‡<br>By do przodu iÅ›Ä‡<br><br>Powiedz czego chcesz<br>Popatrz na mnie powiedz â€jest okejâ€<br>Popatrz na mnie powiedz â€jest okejâ€<br>I potem przytul mnie<br>Szepnij mi do ucha â€jest okejâ€<br>Podaj rÄ™kÄ™ kiedy bÄ™dzie Åºle<br>Powiedz czego chcesz<br>Popatrz na mnie powiedz â€jest okejâ€<br>Popatrz na mnie powiedz â€jest okejâ€<br>I potem przytul mnie<br>Szepnij mi do ucha â€jest okejâ€<br>Podaj rÄ™kÄ™ kiedy bÄ™dzie Åºle<br>Powiedz czego chcesz<br>Popatrz na mnie powiedz â€jest okejâ€<br>Popatrz na mnie powiedz â€jest okejâ€<br>I potem przytul mnie<br>Szepnij mi do ucha â€jest okejâ€<br>Podaj rÄ™kÄ™ kiedy bÄ™dzie Åºle<br>Powiedz czego chcesz<br>Popatrz na mnie powiedz â€jest okejâ€<br>Popatrz na mnie powiedz â€jest okejâ€<br>I potem przytul mnie<br>Szepnij mi do ucha â€jest okejâ€<br>Podaj rÄ™kÄ™ kiedy bÄ™dzie Åºle",
    background: "linear-gradient(#e81e2a, #121212)",
    lyricsBackground: "#e81e2a",
    explicit: "1"
  },
  {
    title: "S3N!",
    artist: "Young Multi",
    album: "TOXIC",
    src: "music/sen.mp3",
    cover: "img/toxic.png",
    coverSize: "1200x1200",
    lyrics: "Ponad chmurami lecÄ™, patrzÄ™ znÃ³w na ciebie<br>MogÄ™ mieÄ‡ co chcÄ™, a chcÄ™ mieÄ‡ tylko ciebie<br>Silnik auta ryczy wiÄ™c, juÅ¼ dobrze wiesz kto jedzie<br>Przejmujemy od was ster, zaczynamy nowy dzieÅ„<br>Nowy dzieÅ„ BoÅ¼e co za dzieÅ„, jeÅ›li to jest sen<br>To proszÄ™ nie budÅº mnie, wielkie marzenia<br>W koÅ„cu odnalazÅ‚em Å¼ycia sens, jeÅ›li to jest sen<br>To proszÄ™ nie budÅº mnie, proszÄ™ nie budÅº uh<br><br>DuÅ¼y check duÅ¼y flex uh uh<br>DuÅ¼y hejt mocny seks uh uh<br>ZÅ‚oty chain nie Å¼aden fake uh uh<br>Jak krzyczÄ™ gang to fÃ¼r die Gang<br>Znowu chodzÄ™ zamulony, ale nie przez trawÄ™<br>W nocy piszÄ™ zwroty, pewnie skoÅ„czÄ™ je nad ranem<br>Ambicje mi nie dajÄ… spaÄ‡ (spaÄ‡)<br>MaÅ‚y Multi duÅ¼y Å›wiat<br>MaÅ‚y Multi duÅ¼y skarb<br>MaÅ‚y Multi duÅ¼y bank yeah<br>Presja siada mi na baniÄ™, nie chcÄ™ juÅ¼ nikogo zawieÅ›Ä‡<br>ChcÄ™ wyjechaÄ‡ gdzieÅ› daleko, szybko jak na autobahnie<br>Chcieli goniÄ‡ nie dogoniÄ… nas, nie nie to ja wolny tak jak ptak<br><br>Ponad chmurami lecÄ™, patrzÄ™ znÃ³w na ciebie<br>MogÄ™ mieÄ‡ co chcÄ™, a chcÄ™ mieÄ‡ tylko ciebie<br>Silnik auta ryczy wiÄ™c, juÅ¼ dobrze wiesz kto jedzie<br>Przejmujemy od was ster, zaczynamy nowy dzieÅ„<br>Nowy dzieÅ„ BoÅ¼e co za dzieÅ„, jeÅ›li to jest sen<br>To proszÄ™ nie budÅº mnie, wielkie marzenia<br>W koÅ„cu odnalazÅ‚em Å¼ycia sens, jeÅ›li to jest sen<br>To proszÄ™ nie budÅº mnie, proszÄ™ nie budÅº uh<br><br>DuÅ¼y check duÅ¼y flex uh uh<br>DuÅ¼y hejt mocny seks uh uh<br>ZÅ‚oty chain nie Å¼aden fake uh uh<br>Jak krzyczÄ™ gang to fÃ¼r die Gang<br>Popatrz mi w oczy i zÅ‚ap mnie za rÄ™kÄ™, kolorujÄ™ Å›wiat<br>W dÅ‚oni trzymasz kolorowe te pÄ™dzle, dawno odszedÅ‚ strach<br>Znowu doÅ¼ylnie pompujesz mi szczÄ™Å›cie, czujÄ™ zmÄ™czenie i presjÄ™<br>PomÃ³Å¼ mi przeÅ¼yÄ‡ bo sam to nie przejdÄ™, moÅ¼e siÄ™ uda wydostaÄ‡ nadziejÄ™<br>Huh huh nie chcÄ™ byÄ‡ sam<br>Huh huh chcÄ™ zatrzymaÄ‡ czas<br>W kaÅ¼dym miejscu mogÄ™ byÄ‡, liczy siÄ™ gdzie jesteÅ› ty<br><br>Ponad chmurami lecÄ™, patrzÄ™ znÃ³w na ciebie<br>MogÄ™ mieÄ‡ co chcÄ™, a chcÄ™ mieÄ‡ tylko ciebie<br>Silnik auta ryczy wiÄ™c, juÅ¼ dobrze wiesz kto jedzie<br>Przejmujemy od was ster, zaczynamy nowy dzieÅ„<br>Nowy dzieÅ„ BoÅ¼e co za dzieÅ„, jeÅ›li to jest sen<br>To proszÄ™ nie budÅº mnie, wielkie marzenia<br>W koÅ„cu odnalazÅ‚em Å¼ycia sens, jeÅ›li jest to sen<br>To proszÄ™ nie budÅº mnie, proszÄ™ nie budÅº",
    background: "linear-gradient(#e81e2a, #121212)",
    lyricsBackground: "#e81e2a",
    explicit: "1"
  },
  {
    title: "TOXIC LUV",
    artist: "Young Multi, White 2115",
    album: "TOXIC",
    src: "music/toxic-luv.mp3",
    cover: "img/toxic.png",
    coverSize: "1200x1200",
    lyrics: "W moim sercu pustka<br>Nie mÃ³w do mnie skarbie<br>No bo juÅ¼ mnie nie oszukasz<br>Å»yjÄ™ szybko jakby dla mnie juÅ¼ nie byÅ‚o jutra<br>PrzestaÅ„ mnie juÅ¼ szukaÄ‡<br>ProszÄ™ przestaÅ„ szukaÄ‡<br>W moim sercu pustka<br>Nie mÃ³w do mnie skarbie<br>No bo juÅ¼ mnie nie oszukasz<br>",
    background: "linear-gradient(#e81e2a, #121212)",
    lyricsBackground: "#e81e2a",
    explicit: "1"
  },
  {
    title: "FANTA",
    artist: "Young Multi, Waima",
    album: "TOXIC",
    src: "music/fanta.mp3",
    cover: "img/toxic.png",
    coverSize: "1200x1200",
    lyrics: "Yeah, yeah, kaÅ¼dy z ziomali jest z innej planety, yeah<br>CaÅ‚a galaktyka nasza, a niebo fioletowe jest, tak jak Fanta<br>WyjebaÅ‚em jak kometa i jestem na topie, a woÅ‚ajÄ… falstart<br>Kokpit zamkniÄ™ty, niedowiarkom mÃ³wiÄ™ dziÅ› pa-pa (pa-pa)<br>",
    background: "linear-gradient(#e81e2a, #121212)",
    lyricsBackground: "#e81e2a",
    explicit: "1"
  },
  {
    title: "NIGDY NIE ÅšPIÄ˜",
    artist: "Young Multi",
    album: "TOXIC",
    src: "music/nigdy-nie-spie.mp3",
    cover: "img/toxic.png",
    coverSize: "1200x1200",
    lyrics: "Nigdy uh nigdy nie Å›piÄ™, 24 gang nie jestem skejtem<br>Nigdy uh nigdy nie Å›piÄ™, robiÄ™ tÄ… bi big booty w Benzie<br>Nigdy uh nigdy nie Å›piÄ™, 24 gang nie jestem skejtem<br>Nigdy uh nigdy nie Å›piÄ™, robiÄ™ tÄ… bih big booty w Benzie<br>Nigdy uh<br>Pomimo Å¼e piÄ™kna pani, to nie mogÄ™ goniÄ‡ za niÄ… tak jak berek<br>Love no thotties jak Keef, ale czasami nie myÅ›lÄ™ juÅ¼ sercem<br>Suko kim ty jesteÅ›, nie mÃ³w do mnie kiedy lecÄ™ na wavie<br>Psujesz mi mood, odejdÅº ode mnie i proszÄ™ zrÃ³b miejsce<br>Moi ziomale to slimes, ty jesteÅ› fake ty jesteÅ› clown<br>Moi ziomale to slimes, wy macie glock my chcemy funk<br>Moi ziomale to slimes, wpierdala w opps dawaj mi guap<br>Moi ziomale to slimes<br>Moi ziomale to gang gang",
    background: "linear-gradient(#e81e2a, #121212)",
    lyricsBackground: "#e81e2a",
    explicit: "1"
  },
  {
    title: "Charger",
    artist: "Chivas",
    album: "nauczyÅ‚em siÄ™ przeklinaÄ‡",
    src: "music/Charger.mp3",
    cover: "img/charger.png",
    coverSize: "592x592",
    lyrics: "Jestem przyjacielem moich zmartwieÅ„, ryczaÅ‚em jak Charger<br>JuÅ¼ nie ma odwrotu, wiÄ™c przeÅ¼yje lub padnÄ™<br>Rzucili nam kolczatkÄ™, zrobiÅ‚em z niej parkiet<br>Nie Å¼aÅ‚ujÄ™ Å¼adnych krzywd, napisaÅ‚y bajkÄ™",
    background: "linear-gradient(#46ca40, #121212)",
    lyricsBackground: "#46ca40",
    explicit: "1"
  },
  {
    title: "PAMIÄ˜TAM JAK",
    artist: "Sobel",
    album: "NAPISZ JAK BÄ˜DIESZ",
    src: "music/pamietam-jak.mp3",
    cover: "img/njb.png",
    coverSize: "640x640",
    lyrics: "PamiÄ™tam, yeah (Sushi), sushi nad wodÄ…<br>Tylko po to by siÄ™ potknÄ…Ä‡, wylÄ…dowaÄ‡ u mnie<br>PamiÄ™tam jak (mÃ³wisz), Å¼e bÄ™dziesz obok, choÄ‡by mierzyli do nas<br>JesteÅ› gotÃ³w dostaÄ‡ kulkÄ™ (Jak dobrze wiedzieÄ‡, Å¼e)<br>Å»e Å¼yjesz, o Å¼yjesz,âŸoâŸÅ¼yjesz,âŸoh yeah<br>(Jak dobrzeâŸwiedzieÄ‡, Å¼e)<br>Å»e poâŸtym wszystkim nadal budzisz siÄ™ tak blisko mnie, yeah",
    background: "linear-gradient(#687c8c, #121212)",
    lyricsBackground: "#687c8c",
    explicit: "1"
  }
];



let currentTrackIndex = 0;
let isShuffle = false;
let isLoop = false;

const audio = document.getElementById("audio");
const playBtn = document.getElementById("play");
const prevBtn = document.getElementById("prev");
const nextBtn = document.getElementById("next");
const playLyr = document.getElementById("play-lyr");
const prevLyr = document.getElementById("prev-lyr");
const nextLyr = document.getElementById("next-lyr");
const seekBar = document.getElementById("seek");
const seekBarLyr = document.getElementById("seek-lyr");
const playMini = document.getElementById("play-mini");
const currentTimeElem = document.getElementById("current-time");
const durationElem = document.getElementById("duration");
const titleElem = document.querySelector("h1");
const artistElem = document.querySelector("h2");
const imgElem = document.getElementById("img1");
const titleElemLyr = document.querySelector("h3");
const artistElemLyr = document.querySelector("h4");
const imgElemLyr = document.getElementById("img2");
const odtwarzanie = document.getElementById("head");
const lyrics = document.getElementById("lyrics-new");
const shuffleBtn = document.getElementById("shuffle");
const loopBtn = document.getElementById("loop");
const loopBtnLyr = document.getElementById("loop-lyr");


let isPlaying = false;

function loadTrack(index) {
  const track = playlist[index];
  audio.src = track.src;
  titleElem.textContent = track.title;
  artistElem.textContent = track.artist;
  imgElem.src = track.cover;
  titleElemLyr.textContent = track.title;
  artistElemLyr.textContent = track.artist;
  imgElemLyr.src = track.cover;
  seekBar.value = 0;
  updateSeekBackground();
  currentTimeElem.textContent = "0:00";
  durationElem.textContent = "0:00";
  odtwarzanie.innerHTML = `
    <div id="go-back"><i class="icon-open"></i></div>
    â€${track.album}â€
    <div id="more"><i class="icon-more"></i></div>
  `;
  lyrics.innerHTML = `${track.lyrics}`;
  document.getElementById("player-container").style.background = track.background;
  document.querySelector("#mini-track-info h5").textContent = track.title;
  document.querySelector("#mini-track-info h6").textContent = track.artist;
  document.getElementById("img3").src = track.cover;
  document.getElementById('player-mini').style.background = track.lyricsBackground;

  if (`${track.explicit}` == '1') {
    titleElem.innerHTML += '<p id="explicit">ğŸ…´</p>';
    titleElemLyr.innerHTML += '<p id="explicit">ğŸ…´</p>';
  }

  document.getElementById("lyrics-overlay").style.backgroundColor = track.lyricsBackground;
  document.getElementById("lyrics-new").style.backgroundColor = track.lyricsBackground;
  document.getElementById("song-info").style.backgroundColor = track.lyricsBackground;
  document.getElementById("bottom-bar").style.backgroundColor = track.lyricsBackground;
}

audio.addEventListener("play", () => {
  setMediaMetadata(currentTrackIndex);
});

function setMediaMetadata(index) {
  const track = playlist[index];
  if ('mediaSession' in navigator) {
    navigator.mediaSession.metadata = new MediaMetadata({
      title: track.title,
      artist: track.artist,
      album: track.album,
      artwork: [
        {
          src: `https://jjmusicplayer.github.io/${track.cover}`,
          sizes: track.coverSize || "512x512",
          type: "image/png"
        }
      ]
    });
    navigator.mediaSession.setActionHandler('play', () => {
      playBtn.click();
    });

    navigator.mediaSession.setActionHandler('pause', () => {
      playBtn.click();
    });

    navigator.mediaSession.setActionHandler('previoustrack', () => {
      prevBtn.click();
    });

    navigator.mediaSession.setActionHandler('nexttrack', () => {
      nextBtn.click();
    });
  }
}

function playSong(index) {
  const track = playlist[index];
  audio.src = `${track.src}`;
  audio.play();
  setMediaMetadata(index);
}

function playTrack() {
  audio.play();
  isPlaying = true;
  playBtn.innerHTML = "<i class='icon-pause'></i>";
  playLyr.innerHTML = "<i class='icon-pause'></i>";
  playMini.innerHTML = "<i class='icon-pause'></i>";
}

function pauseTrack() {
  audio.pause();
  isPlaying = false;
  playBtn.innerHTML = "<i class='icon-play'></i>";
  playLyr.innerHTML = "<i class='icon-play'></i>";
  playMini.innerHTML = "<i class='icon-play'></i>";
}

playBtn.addEventListener("click", () => {
  if (isPlaying) {
    pauseTrack();
  } else {
    playTrack();
  }
});

nextBtn.addEventListener("click", () => {
  currentTrackIndex = (currentTrackIndex + 1) % playlist.length;
  loadTrack(currentTrackIndex);
  playTrack();
});

prevBtn.addEventListener("click", () => {
  currentTrackIndex = (currentTrackIndex - 1 + playlist.length) % playlist.length;
  loadTrack(currentTrackIndex);
  playTrack();
});

playLyr.addEventListener("click", () => {
  if (isPlaying) {
    pauseTrack();
  } else {
    playTrack();
  }
});

nextLyr.addEventListener("click", () => {
  currentTrackIndex = (currentTrackIndex + 1) % playlist.length;
  loadTrack(currentTrackIndex);
  playTrack();
});

prevLyr.addEventListener("click", () => {
  currentTrackIndex = (currentTrackIndex - 1 + playlist.length) % playlist.length;
  loadTrack(currentTrackIndex);
  playTrack();
});

playMini.addEventListener("click", () => {
  if (isPlaying) {
    pauseTrack();
  } else {
    playTrack();
  }
});

audio.addEventListener("ended", () => {
  if (isLoop) {
    audio.currentTime = 0;
    playTrack();
  } else if (isShuffle) {
    let newIndex;
    do {
      newIndex = Math.floor(Math.random() * playlist.length);
    } while (newIndex === currentTrackIndex && playlist.length > 1);
    currentTrackIndex = newIndex;
    loadTrack(currentTrackIndex);
    playTrack();
  } else {
    currentTrackIndex = (currentTrackIndex + 1) % playlist.length;
    loadTrack(currentTrackIndex);
    playTrack();
  }
});

audio.addEventListener("timeupdate", () => {
  const percentage = (audio.currentTime / audio.duration) * 100 || 0;
  seekBar.value = percentage;
  seekBarLyr.value = percentage;
  updateSeekBackground();
  currentTimeElem.textContent = formatTime(audio.currentTime);
  durationElem.textContent = formatTime(audio.duration);
});

shuffleBtn.addEventListener("click", () => {
  isShuffle = !isShuffle;
  shuffleBtn.querySelector("i").classList.toggle("active", isShuffle);
});

loopBtn.addEventListener("click", () => {
  isLoop = !isLoop;
  loopBtn.querySelector("i").classList.toggle("active", isLoop);
});

loopBtnLyr.addEventListener("click", () => {
  isLoop = !isLoop;
  loopBtn.querySelector("i").classList.toggle("active", isLoop);
});

seekBar.addEventListener("input", () => {
  audio.currentTime = (seekBar.value / 100) * audio.duration;
  updateSeekBackground();
});

seekBarLyr.addEventListener("input", () => {
  audio.currentTime = (seekBar.value / 100) * audio.duration;
  updateSeekBackground();
});

function updateSeekBackground() {
  const value = seekBar.value;
  seekBar.style.background = `linear-gradient(to right, #ededed ${value}%, rgba(237, 237, 237, 0.1) ${value}%)`;
  seekBarLyr.style.background = `linear-gradient(to right, #ededed ${value}%, rgba(237, 237, 237, 0.1) ${value}%)`;
}

function formatTime(time) {
  if (isNaN(time)) return "0:00";
  const minutes = Math.floor(time / 60);
  const seconds = Math.floor(time % 60);
  return `${minutes}:${seconds.toString().padStart(2, "0")}`;
}

document.addEventListener('keydown', (e) => {
  if (e.code === 'Space') {
    playBtn.click();
  }
  if (e.code === 'ArrowRight') {
    nextBtn.click();
  }
  if (e.code === 'ArrowLeft') {
    prevBtn.click();
  }
});

document.addEventListener("DOMContentLoaded", function () {
  document.getElementById("lyrics")?.addEventListener('click', function () {
    document.getElementById("lyrics-overlay")?.classList.toggle('hidden');
  });

  document.getElementById("hide-lyrics")?.addEventListener('click', function () {
    document.getElementById("lyrics-overlay")?.classList.toggle('hidden');
  });

  document.getElementById("player-mini")?.addEventListener('click', function () {
    document.getElementById("player-container")?.classList.toggle('hidden');
    document.getElementById("container").classList.toggle('hidden');
  });

  document.getElementById("img3")?.addEventListener('click', function () {
    document.getElementById("player-container")?.classList.toggle('hidden');
    document.getElementById("container").classList.toggle('hidden');
  });

  document.getElementById("head")?.addEventListener('click', function (e) {
    if (e.target.closest("#go-back")) {
      document.getElementById("player-container")?.classList.toggle("hidden");
      document.getElementById("container").classList.toggle('hidden');
    }
  });
});

loadTrack(currentTrackIndex);